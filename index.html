<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Controle 3D com Celular</title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
    <script src="https://unpkg.com/peerjs@1.4.7/dist/peerjs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="ui-layer">
        <div id="initial-choice">
            <h1>Controle 3D com Celular</h1>
            <button class="btn" onclick="app.createRoom()">ğŸ–¥ï¸ Criar Sala</button>
            <button class="btn btn-secondary" onclick="app.showJoinRoom()">ğŸ“± Entrar em Sala</button>
        </div>

        <div id="host-view" style="display:none;">
            <h2>Escaneie com seu celular</h2>
            <div id="qrcode"></div>
            <p>Ou acesse com o cÃ³digo</p>
            <h2 id="my-peer-id">Gerando...</h2>
            <p style="font-size: 13px; opacity: 0.5;">(Toque para copiar)</p>
        </div>

        <div id="join-room" style="display:none;">
            <h2>Digite o cÃ³digo</h2>
            <input type="text" id="room-id-input" placeholder="ABC12" maxlength="5">
            <button class="btn" onclick="app.joinRoom()">Conectar</button>
            <button class="btn btn-neutral" onclick="app.showInitialChoice()">Voltar</button>
        </div>

        <div id="mobile-connecting" style="display:none;">
            <h2>Conectando...</h2>
            <div style="font-size: 72px; margin: 40px 0; opacity: 0.3;">ğŸ“±</div>
            <p id="connection-status">Aguardando conexÃ£o</p>
        </div>
    </div>

    <div id="status-bar">Status: Inicializando...</div>

    <div id="debug-panel">
        <h3>ğŸ“Š Debug</h3>
        <div class="value">Alpha: <span id="debug-alpha">0</span>Â°</div>
        <div class="value">Beta: <span id="debug-beta">0</span>Â°</div>
        <div class="value">Gamma: <span id="debug-gamma">0</span>Â°</div>
        <hr style="border-color: rgba(245, 245, 247, 0.1); margin: 16px 0;">
        <label style="color: rgba(245, 245, 247, 0.6); font-size: 12px;">Mapeamento</label>
        <select id="mapping-mode" onchange="app.changeMappingMode()">
            <option value="standard" selected>PadrÃ£o</option>
            <option value="portrait">Retrato</option>
            <option value="landscape">Paisagem</option>
            <option value="direct">Direto</option>
            <option value="direct-swapped">Swapped</option>
            <option value="inverted">Invertido</option>
        </select>
        <hr style="border-color: rgba(245, 245, 247, 0.1); margin: 16px 0;">
        <label style="color: rgba(245, 245, 247, 0.6); font-size: 12px;">Modelo 3D</label>
        <input type="file" id="model-upload" accept=".glb,.gltf" style="display: none;">
        <button onclick="app.uploadModel()" style="width: 100%; padding: 10px; margin: 8px 0; background: rgba(245, 245, 247, 0.1); color: #f5f5f7; border: 1px solid rgba(245, 245, 247, 0.2); border-radius: 8px; cursor: pointer; font-size: 12px; font-family: inherit;">
            ğŸ“¤ Upload
        </button>
        <button onclick="app.resetModel()" style="width: 100%; padding: 10px; margin: 8px 0; background: transparent; color: rgba(245, 245, 247, 0.6); border: 1px solid rgba(245, 245, 247, 0.1); border-radius: 8px; cursor: pointer; font-size: 12px; font-family: inherit;">
            ğŸ”„ Restaurar
        </button>
    </div>

    <div id="mobile-controls">
        <div class="phone-icon">
            <div class="phone-screen" id="virtual-screen"></div>
        </div>
        <h2>Gire seu celular!</h2>
        <p id="mobile-status">Aguardando sensores...</p>
        <button class="btn" onclick="app.requestSensorPermission()">Ativar Sensores</button>
        <div class="sensor-data" id="sensor-debug">X: 0 | Y: 0 | Z: 0</div>
        <div class="sensor-data" style="color: #888; font-size: 12px; margin-top: 10px;">
            Abra o console para ver logs detalhados
        </div>
    </div>

    <script type="module" src="js/app.js"></script>
</body>
</html>
